
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)

############# first, different r and different selection coefficient for model1,h05,mindac1,samples1000  #####################################
myfunc <-function(){
for(ii in 5:9){assign(paste0("model1_h05_r0",ii,".maxdac5.mindac1.samples1000"),cbind(read.table(paste0("results/inbrief/model1_h05_r0",ii,".maxdac5.mindac1.samples1000"),header=TRUE),group=rep(ii)))} ## 读取数据，不同的recombination rate
model1_h05_diffR.maxdac5.mindac1.samples1000<<-rbind(model1_h05_r05.maxdac5.mindac1.samples1000,model1_h05_r06.maxdac5.mindac1.samples1000,model1_h05_r07.maxdac5.mindac1.samples1000,model1_h05_r08.maxdac5.mindac1.samples1000,model1_h05_r09.maxdac5.mindac1.samples1000) ## 合并数据
model1_h05_diffR.maxdac5.mindac1.samples1000<<-model1_h05_diffR.maxdac5.mindac1.samples1000[which(model1_h05_diffR.maxdac5.mindac1.samples1000$Nloci>0),] ## 删除未检测到突变的runs
list.model1_h05.maxdac5.mindac1.samples1000 <<-list(model1_h05_r05.maxdac5.mindac1.samples1000,model1_h05_r06.maxdac5.mindac1.samples1000,model1_h05_r07.maxdac5.mindac1.samples1000,model1_h05_r08.maxdac5.mindac1.samples1000,model1_h05_r09.maxdac5.mindac1.samples1000) ## 整理读入的数据
list.VariantType<<-c("0","-0.0001","-0.001","-0.01","-0.1","DFE")

data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac5.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac5.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD[nn,1]=vv;data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD[nn,2]=(ii+4);data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD[nn,3:5]=fivenum(list.model1_h05.maxdac5.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac5.mindac1.samples1000[[ii]][,1]==vv),7])[2:4]}};colnames(data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD<<-data.frame(data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD)
data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD$VariantType<<-factor(data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

data.list.model1_h05.maxdac5.mindac1.samples1000.cor=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac5.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac5.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac5.mindac1.samples1000.cor[nn,1]=vv;data.list.model1_h05.maxdac5.mindac1.samples1000.cor[nn,2]=(ii+4);data.list.model1_h05.maxdac5.mindac1.samples1000.cor[nn,3:5]=fivenum(list.model1_h05.maxdac5.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac5.mindac1.samples1000[[ii]][,1]==vv),8])[2:4]}};colnames(data.list.model1_h05.maxdac5.mindac1.samples1000.cor)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac5.mindac1.samples1000.cor<<-data.frame(data.list.model1_h05.maxdac5.mindac1.samples1000.cor)
data.list.model1_h05.maxdac5.mindac1.samples1000.cor$VariantType<<-factor(data.list.model1_h05.maxdac5.mindac1.samples1000.cor$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

data.list.model1_h05.maxdac5.mindac1.samples1000.corabs=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac5.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac5.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac5.mindac1.samples1000.corabs[nn,1]=vv;data.list.model1_h05.maxdac5.mindac1.samples1000.corabs[nn,2]=(ii+4);data.list.model1_h05.maxdac5.mindac1.samples1000.corabs[nn,3:5]=fivenum(list.model1_h05.maxdac5.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac5.mindac1.samples1000[[ii]][,1]==vv),9])[2:4]}};colnames(data.list.model1_h05.maxdac5.mindac1.samples1000.corabs)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac5.mindac1.samples1000.corabs<<-data.frame(data.list.model1_h05.maxdac5.mindac1.samples1000.corabs)
data.list.model1_h05.maxdac5.mindac1.samples1000.corabs$VariantType<<-factor(data.list.model1_h05.maxdac5.mindac1.samples1000.corabs$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

##############  max derive allele count = 5  ######################

for(ii in 5:9){assign(paste0("model1_h05_r0",ii,".maxdac3.mindac1.samples1000"),cbind(read.table(paste0("results/inbrief/model1_h05_r0",ii,".maxdac3.mindac1.samples1000"),header=TRUE),group=rep(ii)))}
model1_h05_diffR.maxdac3.mindac1.samples1000<<-rbind(model1_h05_r05.maxdac3.mindac1.samples1000,model1_h05_r06.maxdac3.mindac1.samples1000,model1_h05_r07.maxdac3.mindac1.samples1000,model1_h05_r08.maxdac3.mindac1.samples1000,model1_h05_r09.maxdac3.mindac1.samples1000)
model1_h05_diffR.maxdac3.mindac1.samples1000<<-model1_h05_diffR.maxdac3.mindac1.samples1000[which(model1_h05_diffR.maxdac3.mindac1.samples1000$Nloci>0),]
list.model1_h05.maxdac3.mindac1.samples1000 <<-list(model1_h05_r05.maxdac3.mindac1.samples1000,model1_h05_r06.maxdac3.mindac1.samples1000,model1_h05_r07.maxdac3.mindac1.samples1000,model1_h05_r08.maxdac3.mindac1.samples1000,model1_h05_r09.maxdac3.mindac1.samples1000)
#list.VariantType<<-c("0","-0.0001","-0.001","-0.01","-0.1","DFE")

data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac3.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac3.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD[nn,1]=vv;data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD[nn,2]=(ii+4);data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD[nn,3:5]=fivenum(list.model1_h05.maxdac3.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac3.mindac1.samples1000[[ii]][,1]==vv),7])[2:4]}};colnames(data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD<<-data.frame(data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD)
data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD$VariantType<<-factor(data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

data.list.model1_h05.maxdac3.mindac1.samples1000.cor=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac3.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac3.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac3.mindac1.samples1000.cor[nn,1]=vv;data.list.model1_h05.maxdac3.mindac1.samples1000.cor[nn,2]=(ii+4);data.list.model1_h05.maxdac3.mindac1.samples1000.cor[nn,3:5]=fivenum(list.model1_h05.maxdac3.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac3.mindac1.samples1000[[ii]][,1]==vv),8])[2:4]}};colnames(data.list.model1_h05.maxdac3.mindac1.samples1000.cor)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac3.mindac1.samples1000.cor<<-data.frame(data.list.model1_h05.maxdac3.mindac1.samples1000.cor)
data.list.model1_h05.maxdac3.mindac1.samples1000.cor$VariantType<<-factor(data.list.model1_h05.maxdac3.mindac1.samples1000.cor$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

data.list.model1_h05.maxdac3.mindac1.samples1000.corabs=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac3.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac3.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac3.mindac1.samples1000.corabs[nn,1]=vv;data.list.model1_h05.maxdac3.mindac1.samples1000.corabs[nn,2]=(ii+4);data.list.model1_h05.maxdac3.mindac1.samples1000.corabs[nn,3:5]=fivenum(list.model1_h05.maxdac3.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac3.mindac1.samples1000[[ii]][,1]==vv),9])[2:4]}};colnames(data.list.model1_h05.maxdac3.mindac1.samples1000.corabs)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac3.mindac1.samples1000.corabs<<-data.frame(data.list.model1_h05.maxdac3.mindac1.samples1000.corabs)
data.list.model1_h05.maxdac3.mindac1.samples1000.corabs$VariantType<<-factor(data.list.model1_h05.maxdac3.mindac1.samples1000.corabs$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))
##############  max derive allele count = 3  ######################

for(ii in 5:9){assign(paste0("model1_h05_r0",ii,".maxdac1.mindac1.samples1000"),cbind(read.table(paste0("results/inbrief/model1_h05_r0",ii,".maxdac1.mindac1.samples1000"),header=TRUE),group=rep(ii)))}
model1_h05_diffR.maxdac1.mindac1.samples1000<<-rbind(model1_h05_r05.maxdac1.mindac1.samples1000,model1_h05_r06.maxdac1.mindac1.samples1000,model1_h05_r07.maxdac1.mindac1.samples1000,model1_h05_r08.maxdac1.mindac1.samples1000,model1_h05_r09.maxdac1.mindac1.samples1000)
model1_h05_diffR.maxdac1.mindac1.samples1000<<-model1_h05_diffR.maxdac1.mindac1.samples1000[which(model1_h05_diffR.maxdac1.mindac1.samples1000$Nloci>0),]
list.model1_h05.maxdac1.mindac1.samples1000 <<-list(model1_h05_r05.maxdac1.mindac1.samples1000,model1_h05_r06.maxdac1.mindac1.samples1000,model1_h05_r07.maxdac1.mindac1.samples1000,model1_h05_r08.maxdac1.mindac1.samples1000,model1_h05_r09.maxdac1.mindac1.samples1000)
#list.VariantType<<-c("0","-0.0001","-0.001","-0.01","-0.1","DFE")

data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac1.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac1.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD[nn,1]=vv;data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD[nn,2]=(ii+4);data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD[nn,3:5]=fivenum(list.model1_h05.maxdac1.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac1.mindac1.samples1000[[ii]][,1]==vv),7])[2:4]}};colnames(data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD<<-data.frame(data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD)
data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD$VariantType<<-factor(data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

data.list.model1_h05.maxdac1.mindac1.samples1000.cor=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac1.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac1.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac1.mindac1.samples1000.cor[nn,1]=vv;data.list.model1_h05.maxdac1.mindac1.samples1000.cor[nn,2]=(ii+4);data.list.model1_h05.maxdac1.mindac1.samples1000.cor[nn,3:5]=fivenum(list.model1_h05.maxdac1.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac1.mindac1.samples1000[[ii]][,1]==vv),8])[2:4]}};colnames(data.list.model1_h05.maxdac1.mindac1.samples1000.cor)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac1.mindac1.samples1000.cor<<-data.frame(data.list.model1_h05.maxdac1.mindac1.samples1000.cor)
data.list.model1_h05.maxdac1.mindac1.samples1000.cor$VariantType<<-factor(data.list.model1_h05.maxdac1.mindac1.samples1000.cor$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))

data.list.model1_h05.maxdac1.mindac1.samples1000.corabs=matrix(nrow=length(list.VariantType)*length(list.model1_h05.maxdac1.mindac1.samples1000),ncol=5);nn=0;for(vv in list.VariantType){for(ii in 1:length(list.model1_h05.maxdac1.mindac1.samples1000)){nn=nn+1;data.list.model1_h05.maxdac1.mindac1.samples1000.corabs[nn,1]=vv;data.list.model1_h05.maxdac1.mindac1.samples1000.corabs[nn,2]=(ii+4);data.list.model1_h05.maxdac1.mindac1.samples1000.corabs[nn,3:5]=fivenum(list.model1_h05.maxdac1.mindac1.samples1000[[ii]][which(list.model1_h05.maxdac1.mindac1.samples1000[[ii]][,1]==vv),9])[2:4]}};colnames(data.list.model1_h05.maxdac1.mindac1.samples1000.corabs)<<-c("VariantType","r","Q1","Q2","Q3");data.list.model1_h05.maxdac1.mindac1.samples1000.corabs<<-data.frame(data.list.model1_h05.maxdac1.mindac1.samples1000.corabs)
data.list.model1_h05.maxdac1.mindac1.samples1000.corabs$VariantType<<-factor(data.list.model1_h05.maxdac1.mindac1.samples1000.corabs$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))
##############  max derive allele count = 1  ######################

pic_data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD<<-ggplot(data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by V/Va",title="model1_h05.maxdac5.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac5.mindac1.samples1000.cor<<-ggplot(data.list.model1_h05.maxdac5.mindac1.samples1000.cor,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by cor",title="model1_h05.maxdac5.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac5.mindac1.samples1000.corabs<<-ggplot(data.list.model1_h05.maxdac5.mindac1.samples1000.corabs,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by corabs",title="model1_h05.maxdac5.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD<<-ggplot(data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by V/Va",title="model1_h05.maxdac3.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac3.mindac1.samples1000.cor<<-ggplot(data.list.model1_h05.maxdac3.mindac1.samples1000.cor,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by cor",title="model1_h05.maxdac3.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac3.mindac1.samples1000.corabs<<-ggplot(data.list.model1_h05.maxdac3.mindac1.samples1000.corabs,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by corabs",title="model1_h05.maxdac3.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD<<-ggplot(data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by V/Va",title="model1_h05.maxdac1.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac1.mindac1.samples1000.cor<<-ggplot(data.list.model1_h05.maxdac1.mindac1.samples1000.cor,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by cor",title="model1_h05.maxdac1.mindac1.samples1000")+guides(shape=F,color=F)
pic_data.list.model1_h05.maxdac1.mindac1.samples1000.corabs<<-ggplot(data.list.model1_h05.maxdac1.mindac1.samples1000.corabs,aes(x=VariantType,y=as.numeric(Q2),group=r,color=r,shape=r))+geom_point()+geom_line(aes(color=r))+theme_bw()+labs(x="Selection coefficient (h=0.5)",y="NetLD by corabs",title="model1_h05.maxdac1.mindac1.samples1000")+guides(shape=F,color=F)
grid.arrange(pic_data.list.model1_h05.maxdac5.mindac1.samples1000.NetLD,pic_data.list.model1_h05.maxdac5.mindac1.samples1000.cor,pic_data.list.model1_h05.maxdac5.mindac1.samples1000.corabs,pic_data.list.model1_h05.maxdac3.mindac1.samples1000.NetLD,pic_data.list.model1_h05.maxdac3.mindac1.samples1000.cor,pic_data.list.model1_h05.maxdac3.mindac1.samples1000.corabs,pic_data.list.model1_h05.maxdac1.mindac1.samples1000.NetLD,pic_data.list.model1_h05.maxdac1.mindac1.samples1000.cor,pic_data.list.model1_h05.maxdac1.mindac1.samples1000.corabs,ncol=3)
############## max derive allele count = 5/3/1  ######################

######################################################################################################
#model1_h05_diffR.maxdac5.mindac1.samples1000$VariantType<<-factor(model1_h05_diffR.maxdac5.mindac1.samples1000$VariantType,levels=c("0","-0.0001","-0.001","-0.01","-0.1","DFE"))
#model1_h05_diffR.maxdac5.mindac1.samples1000_cor<<-ggplot(model1_h05_diffR.maxdac5.mindac1.samples1000,aes(x=VariantType,y=as.numeric(cor),color=group))+geom_boxplot()+ylim(-0.005,0.005)
#model1_h05_diffR.maxdac5.mindac1.samples1000_corabs<<-ggplot(model1_h05_diffR.maxdac5.mindac1.samples1000,aes(x=VariantType,y=as.numeric(cor_abs),color=group))+geom_boxplot()+ylim(0,0.015)
#model1_h05_diffR.maxdac5.mindac1.samples1000_NetLD<<-ggplot(model1_h05_diffR.maxdac5.mindac1.samples1000,aes(x=VariantType,y=as.numeric(NetLD),color=group))+geom_boxplot()+ylim(-1e-05,2e-05)
#grid.arrange(model1_h05_diffR.maxdac5.mindac1.samples1000_cor,model1_h05_diffR.maxdac5.mindac1.samples1000_corabs,model1_h05_diffR.maxdac5.mindac1.samples1000_NetLD)
#########################################################################################################################################################################################################################
}
