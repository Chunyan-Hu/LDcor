
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
#library("ggsci")
library(RColorBrewer)
library(cowplot)
library(ggpubr)


model1_h05_r08_diffMDac_N10000.samples1000=read.table(file="../data/fig3_model1_h05_r08_diffMDac_N10000.samples1000")
model2_h05_r08_diffMDac_N10000.samples1000=read.table(file="../data/fig3_model2_h05_r08_diffMDac_N10000.samples1000")
model3_h05_r08_diffMDac_N10000.samples1000=read.table(file="../data/fig3_model3_h05_r08_diffMDac_N10000.samples1000")

fig3_model1_r08_N1_plot_signedsqrtr2<-ggplot(model1_h05_r08_diffMDac_N10000.samples1000,aes(x=V6,y=V8,shape=factor(V12),color=factor(V12),width=0.3))+geom_point(alpha=0.4,size=1.2)+theme_classic()+labs(x=expression(paste("signed ",sqrt(r^2))),y="LDcor",title="model1")+theme(legend.position = "none",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_color_manual(values=c("#9ECAE1","#AE017E","#DE2D26"))+geom_smooth(method='lm',se=T)+stat_cor()+scale_x_continuous(expand=c(0,0),limits=c(0.002,0.006),breaks=seq(0.002,0.006,0.001))+scale_y_continuous(expand=c(0,0),limits=c(0.001,0.004),breaks=seq(0.001,0.004,0.001))
fig3_model1_r08_N1_plot_sqrtr2<-ggplot(model1_h05_r08_diffMDac_N10000.samples1000,aes(x=V2,y=V9,shape=factor(V12),color=factor(V12),width=0.3))+geom_point(alpha=0.4,size=1.2)+theme_classic()+labs(x=expression(sqrt(r^2)),y="LDcorabs",title="model1")+theme(legend.position = "none",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_color_manual(values=c("#9ECAE1","#AE017E","#DE2D26"))+geom_smooth(method='lm',se=T)+stat_cor()+scale_x_continuous(expand=c(0,0),limits=c(0.005,0.013),breaks=seq(0.005,0.013,0.002))+scale_y_continuous(expand=c(0,0),limits=c(0.007,0.016),breaks=seq(0.007,0.016,0.003))
fig3_model2_r08_N1_plot_signedsqrtr2<-ggplot(model2_h05_r08_diffMDac_N10000.samples1000,aes(x=V6,y=V8,shape=factor(V12),color=factor(V12),width=0.3))+geom_point(alpha=0.4,size=1.2)+theme_classic()+labs(x=expression(paste("signed ",sqrt(r^2))),y="LDcor",title="model2")+theme(legend.position = "none",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_color_manual(values=c("#9ECAE1","#AE017E","#DE2D26"))+geom_smooth(method='lm',se=T)+stat_cor()+scale_x_continuous(expand=c(0,0),limits=c(0.002,0.006),breaks=seq(0.002,0.006,0.001))+scale_y_continuous(expand=c(0,0),limits=c(0.001,0.004),breaks=seq(0.001,0.004,0.001))
fig3_model2_r08_N1_plot_sqrtr2<-ggplot(model2_h05_r08_diffMDac_N10000.samples1000,aes(x=V2,y=V9,shape=factor(V12),color=factor(V12),width=0.3))+geom_point(alpha=0.4,size=1.2)+theme_classic()+labs(x=expression(sqrt(r^2)),y="LDcorabs",title="model2")+theme(legend.position = c(0.2,0.8),legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_color_manual(values=c("#9ECAE1","#AE017E","#DE2D26"))+geom_smooth(method='lm',se=T)+stat_cor()+scale_x_continuous(expand=c(0,0),limits=c(0.005,0.013),breaks=seq(0.005,0.013,0.002))+scale_y_continuous(expand=c(0,0),limits=c(0.007,0.016),breaks=seq(0.007,0.016,0.003))
fig3_model3_r08_N1_plot_signedsqrtr2<-ggplot(model3_h05_r08_diffMDac_N10000.samples1000,aes(x=V6,y=V8,shape=factor(V12),color=factor(V12),width=0.3))+geom_point(alpha=0.4,size=1.2)+theme_classic()+labs(x=expression(paste("signed ",sqrt(r^2))),y="LDcor",title="model3")+theme(legend.position = "none",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_color_manual(values=c("#9ECAE1","#AE017E","#DE2D26"))+geom_smooth(method='lm',se=T)+stat_cor()+scale_x_continuous(expand=c(0,0),limits=c(0.002,0.006),breaks=seq(0.002,0.006,0.001))+scale_y_continuous(expand=c(0,0),limits=c(0.001,0.004),breaks=seq(0.001,0.004,0.001))
fig3_model3_r08_N1_plot_sqrtr2<-ggplot(model3_h05_r08_diffMDac_N10000.samples1000,aes(x=V2,y=V9,shape=factor(V12),color=factor(V12),width=0.3))+geom_point(alpha=0.4,size=1.2)+theme_classic()+labs(x=expression(sqrt(r^2)),y="LDcorabs",title="model3")+theme(legend.position = "none",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_color_manual(values=c("#9ECAE1","#AE017E","#DE2D26"))+geom_smooth(method='lm',se=T)+stat_cor()+scale_x_continuous(expand=c(0,0),limits=c(0.005,0.013),breaks=seq(0.005,0.013,0.002))+scale_y_continuous(expand=c(0,0),limits=c(0.007,0.016),breaks=seq(0.007,0.016,0.003))

fig2<-plot_grid(fig3_model1_r08_N1_plot_signedsqrtr2,fig3_model3_r08_N1_plot_signedsqrtr2,fig3_model2_r08_N1_plot_signedsqrtr2,fig3_model1_r08_N1_plot_sqrtr2,fig3_model3_r08_N1_plot_sqrtr2,fig3_model2_r08_N1_plot_sqrtr2,ncol=3,align="vh")
ggsave("fig3A.LD_plot_s0.svg",fig2,width = 9, height = 6)

