
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library("ggsci")
library(RColorBrewer)
library(cowplot)
library("ggalt")

list.VariantType<-c(0,-0.0001,-0.001,-0.01,-0.1)

data.list.model1_h05_N10000.maxdac2.mindac2.samples1000.cor=read.table(file="../data/fig1_data.list.model1_h05_N10000.maxdac2.mindac2.samples1000.cor")
data.list.model1_h05_N10000.maxdac2.mindac2.samples1000.corabs=read.table(file="../data/fig1_data.list.model1_h05_N10000.maxdac2.mindac2.samples1000.corabs")

data.list.model2_h05_N10000.maxdac2.mindac2.samples1000.cor=read.table(file="../data/fig1_data.list.model2_h05_N10000.maxdac2.mindac2.samples1000.cor")
data.list.model2_h05_N10000.maxdac2.mindac2.samples1000.corabs=read.table(file="../data/fig1_data.list.model2_h05_N10000.maxdac2.mindac2.samples1000.corabs")

data.list.model3_h05_N10000.maxdac2.mindac2.samples1000.cor=read.table(file="../data/fig1_data.list.model3_h05_N10000.maxdac2.mindac2.samples1000.cor")
data.list.model3_h05_N10000.maxdac2.mindac2.samples1000.corabs=read.table(file="../data/fig1_data.list.model3_h05_N10000.maxdac2.mindac2.samples1000.corabs")

fig1_h05_mindac2_maxdac2_model1_cor<-ggplot(data.list.model1_h05_N10000.maxdac2.mindac2.samples1000.cor,aes(x=factor(VariantType,levels=list.VariantType),y=as.numeric(Mean)*10,group=r))+geom_errorbar(color="#9ECAE1",aes(ymin=(as.numeric(Mean)-as.numeric(Sd)/sqrt(Nruns))*10,ymax=(as.numeric(Mean)+as.numeric(Sd)/sqrt(120))*10),width=0.2)+geom_xspline(spline_shape=-0.6,color="#9ECAE1",aes(linetype=as.factor(-r)))+theme_classic()+labs(x="",y="LDcor (×10)",title="A.Model 1")+theme(legend.position = "bottom",legend.key.size=unit(12,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=12,color="black"),legend.text=element_text(size=12),legend.title=element_text(size=12))+scale_x_discrete(breaks=list.VariantType,labels=c(0,expression(10^-4),expression(10^-3),expression(10^-2),expression(10^-1)))+geom_point(color="#9ECAE1",size=0.8)+scale_y_continuous(expand=c(0,0),limits=c(-0.01,0.13),breaks=seq(-0.01,0.13,0.02))+geom_hline(yintercept=0,lty=2,size=0.6,color="gray")
fig1_h05_mindac2_maxdac2_model1_corabs<-ggplot(data.list.model1_h05_N10000.maxdac2.mindac2.samples1000.corabs,aes(x=factor(VariantType,levels=list.VariantType),y=as.numeric(Mean)*10,group=r))+geom_errorbar(color="#FA9FB5",aes(ymin=(as.numeric(Mean)-as.numeric(Sd)/sqrt(Nruns))*10,ymax=(as.numeric(Mean)+as.numeric(Sd)/sqrt(120))*10),width=0.2)+geom_xspline(spline_shape=-0.6,color="#FA9FB5",aes(linetype=as.factor(-r)))+theme_classic()+labs(x="",y="LDcorabs (×10)",title="B")+theme(legend.position = "bottom",legend.key.size=unit(12,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=12,color="black"),legend.text=element_text(size=12),legend.title=element_text(size=12))+scale_x_discrete(breaks=list.VariantType,labels=c(0,expression(10^-4),expression(10^-3),expression(10^-2),expression(10^-1)))+geom_point(color="#FA9FB5",size=0.8)+scale_y_continuous(expand=c(0,0),limits=c(0.02,0.16),breaks=seq(0.02,0.16,0.02))+geom_hline(yintercept=0,lty=2,size=0.6,color="gray")
fig1_h05_mindac2_maxdac2_model3_cor<-ggplot(data.list.model3_h05_N10000.maxdac2.mindac2.samples1000.cor,aes(x=factor(VariantType,levels=list.VariantType),y=as.numeric(Mean)*10,group=r))+geom_errorbar(color="#9ECAE1",aes(ymin=(as.numeric(Mean)-as.numeric(Sd)/sqrt(Nruns))*10,ymax=(as.numeric(Mean)+as.numeric(Sd)/sqrt(120))*10),width=0.2)+geom_xspline(spline_shape=-0.6,color="#9ECAE1",aes(linetype=as.factor(-r)))+theme_classic()+labs(x="",y="",title="Model 2")+theme(legend.position = "bottom",legend.key.size=unit(12,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=12,color="black"),legend.text=element_text(size=12),legend.title=element_text(size=12))+scale_x_discrete(breaks=list.VariantType,labels=c(0,expression(10^-4),expression(10^-3),expression(10^-2),expression(10^-1)))+geom_point(color="#9ECAE1",size=0.8)+scale_y_continuous(expand=c(0,0),limits=c(-0.01,0.13),breaks=seq(-0.01,0.13,0.02))+geom_hline(yintercept=0,lty=2,size=0.6,color="gray")
fig1_h05_mindac2_maxdac2_model3_corabs<-ggplot(data.list.model3_h05_N10000.maxdac2.mindac2.samples1000.corabs,aes(x=factor(VariantType,levels=list.VariantType),y=as.numeric(Mean)*10,group=r))+geom_errorbar(color="#FA9FB5",aes(ymin=(as.numeric(Mean)-as.numeric(Sd)/sqrt(Nruns))*10,ymax=(as.numeric(Mean)+as.numeric(Sd)/sqrt(120))*10),width=0.2)+geom_xspline(spline_shape=-0.6,color="#FA9FB5",aes(linetype=as.factor(-r)))+theme_classic()+labs(x="Selection coefficient",y="",title="")+theme(legend.position = "bottom",legend.key.size=unit(12,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=12,color="black"),legend.text=element_text(size=12),legend.title=element_text(size=12))+scale_x_discrete(breaks=list.VariantType,labels=c(0,expression(10^-4),expression(10^-3),expression(10^-2),expression(10^-1)))+geom_point(color="#FA9FB5",size=0.8)+scale_y_continuous(expand=c(0,0),limits=c(0.02,0.16),breaks=seq(0.02,0.16,0.02))+geom_hline(yintercept=0,lty=2,size=0.6,color="gray")
fig1_h05_mindac2_maxdac2_model2_cor<-ggplot(data.list.model2_h05_N10000.maxdac2.mindac2.samples1000.cor,aes(x=factor(VariantType,levels=list.VariantType),y=as.numeric(Mean)*10,group=r))+geom_errorbar(color="#9ECAE1",aes(ymin=(as.numeric(Mean)-as.numeric(Sd)/sqrt(Nruns))*10,ymax=(as.numeric(Mean)+as.numeric(Sd)/sqrt(120))*10),width=0.2)+geom_xspline(spline_shape=-0.6,color="#9ECAE1",aes(linetype=as.factor(-r)))+theme_classic()+labs(x="",y="",title="Model 3")+theme(legend.position = "bottom",legend.key.size=unit(12,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=12,color="black"),legend.text=element_text(size=12),legend.title=element_text(size=12))+scale_x_discrete(breaks=list.VariantType,labels=c(0,expression(10^-4),expression(10^-3),expression(10^-2),expression(10^-1)))+geom_point(color="#9ECAE1",size=0.8)+scale_y_continuous(expand=c(0,0),limits=c(-0.01,0.13),breaks=seq(-0.01,0.13,0.02))+geom_hline(yintercept=0,lty=2,size=0.6,color="gray")
fig1_h05_mindac2_maxdac2_model2_corabs<-ggplot(data.list.model2_h05_N10000.maxdac2.mindac2.samples1000.corabs,aes(x=factor(VariantType,levels=list.VariantType),y=as.numeric(Mean)*10,group=r))+geom_errorbar(color="#FA9FB5",aes(ymin=(as.numeric(Mean)-as.numeric(Sd)/sqrt(Nruns))*10,ymax=(as.numeric(Mean)+as.numeric(Sd)/sqrt(120))*10),width=0.2)+geom_xspline(spline_shape=-0.6,color="#FA9FB5",aes(linetype=as.factor(-r)))+theme_classic()+labs(x="",y="",title="")+theme(legend.position = "bottom",legend.key.size=unit(12,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=12,color="black"),legend.text=element_text(size=12),legend.title=element_text(size=12))+scale_x_discrete(breaks=list.VariantType,labels=c(0,expression(10^-4),expression(10^-3),expression(10^-2),expression(10^-1)))+geom_point(color="#FA9FB5",size=0.8)+scale_y_continuous(expand=c(0,0),limits=c(0.02,0.16),breaks=seq(0.02,0.16,0.02))+geom_hline(yintercept=0,lty=2,size=0.6,color="gray")
plot_grid(fig1_h05_mindac2_maxdac2_model1_cor,fig1_h05_mindac2_maxdac2_model3_cor,fig1_h05_mindac2_maxdac2_model2_cor,fig1_h05_mindac2_maxdac2_model1_corabs,fig1_h05_mindac2_maxdac2_model3_corabs,fig1_h05_mindac2_maxdac2_model2_corabs,ncol=3,align="vh")

fig1<-plot_grid(fig1_h05_mindac2_maxdac2_model1_cor,fig1_h05_mindac2_maxdac2_model3_cor,fig1_h05_mindac2_maxdac2_model2_cor,fig1_h05_mindac2_maxdac2_model1_corabs,fig1_h05_mindac2_maxdac2_model3_corabs,fig1_h05_mindac2_maxdac2_model2_corabs,ncol=3,align="vh")
ggsave("fig1B.s_r.se.svg",fig1,width = 9, height = 6)

