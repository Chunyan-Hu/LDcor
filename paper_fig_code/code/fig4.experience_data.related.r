
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library("ggsci")
library(RColorBrewer)
library(cowplot)
library(ggalt)

CEU_cor=read.table(file="../data/fig4_CEU_cor")
CEU_cor_abs=read.table(file="../data/fig4_CEU_cor_abs")
gorGor3_cor=read.table(file="../data/fig4_gorGor3_cor")
gorGor3_cor_abs=read.table(file="../data/fig4_gorGor3_cor_abs")
panda_cor=read.table(file="../data/fig4_panda_cor")
panda_cor_abs=read.table(file="../data/fig4_panda_cor_abs")
sheep_cor=read.table(file="../data/fig4_sheep_cor")
sheep_cor_abs=read.table(file="../data/fig4_sheep_cor_abs")
goldenSM_cor=read.table(file="../data/fig4_goldenSM_cor")
goldenSM_cor_abs=read.table(file="../data/fig4_goldenSM_cor_abs")
macaca_cor=read.table(file="../data/fig4_macaca_cor")
macaca_cor_abs=read.table(file="../data/fig4_macaca_cor_abs")
tiger_cor=read.table(file="../data/fig4_tiger_cor")
tiger_cor_abs=read.table(file="../data/fig4_tiger_cor_abs")

fig3_CEU_cor<-ggplot(CEU_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="C",y="CEU")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(-0.15,0.03),breaks=seq(-0.15,0.03,0.03))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_CEU_cor_abs<-ggplot(CEU_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.03,0.072),breaks=seq(0.03,0.072,0.007))+geom_hline(yintercept=0,lty=2)+xlim(2,10)

fig3_gorGor3_cor<-ggplot(gorGor3_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="C",y="gorGor3")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(-2,1),breaks=seq(-2,1,0.5))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_gorGor3_cor_abs<-ggplot(gorGor3_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.101,0.1601),breaks=seq(0.101,0.161,0.01))+geom_hline(yintercept=0,lty=2)+xlim(2,10)

fig3_panda_cor<-ggplot(panda_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="E",y="Panda")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(-4.6,2),breaks=seq(-4.6,2,1.1))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_panda_cor_abs<-ggplot(panda_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.02,0.14),breaks=seq(0.02,0.14,0.02))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_sheep_cor<-ggplot(sheep_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="Max derived allele count",title="F",y="Sheep")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0,0.3),breaks=seq(0,0.3,0.05))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_sheep_cor_abs<-ggplot(sheep_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="Max derived allele count",title="",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.13,0.172),breaks=seq(0.13,0.172,0.007))+xlim(2,10)
fig3_goldenSM_cor<-ggplot(goldenSM_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="A.LDcor (Ã—100)",y="GoldenSM")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(-0.5,2.5),breaks=seq(-0.5,2.5,0.5))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_goldenSM_cor_abs<-ggplot(goldenSM_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="LDcor_abs",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.1,0.22),breaks=seq(0.1,0.22,0.02))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_macaca_cor<-ggplot(macaca_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="B",y="Macaque")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0,1.5),breaks=seq(0,1.5,0.25))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_macaca_cor_abs<-ggplot(macaca_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.04,0.082),breaks=seq(0.04,0.082,0.007))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_tiger_cor<-ggplot(tiger_cor,aes(x=mdac,y=cor*100,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin*100,ymax=themax*100),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="D",y="Tiger")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0,12),breaks=seq(0,12,2))+geom_hline(yintercept=0,lty=2)+xlim(2,10)
fig3_tiger_cor_abs<-ggplot(tiger_cor_abs,aes(x=mdac,y=cor_abs,colour=VariantType,shape=VariantType,linetype=VariantType))+geom_point(size=0.8)+geom_ribbon(aes(ymin=themin,ymax=themax),alpha=0.1,size=0)+geom_xspline(spline_shape=-0.6,aes(colour=VariantType,linetype=VariantType))+labs(x="",title="",y="")+scale_color_npg(name = "Variant",limits=c("splicenonsense","missense","codingsynononly"))+scale_color_manual(values=c("#AE017E","#9ECAE1","#DE2D26"))+scale_linetype_manual(values=c("dotted","longdash","solid"))+scale_shape_manual(values=c(1,4,8))+theme_classic()+theme(legend.position = "bottom",legend.key.size=unit(10,"pt"),text=element_text(family="serif",size=12),axis.text=element_text(size=10,color="black"),legend.text=element_text(size=10),legend.title=element_text(size=10))+scale_y_continuous(expand=c(0,0),limits=c(0.15,0.21),breaks=seq(0.15,0.21,0.01))+xlim(2,10)

fig3<-plot_grid(fig3_tiger_cor,fig3_tiger_cor_abs,fig3_panda_cor,fig3_panda_cor_abs,fig3_sheep_cor,fig3_sheep_cor_abs,fig3_gorGor3_cor,fig3_gorGor3_cor_abs,fig3_CEU_cor,fig3_CEU_cor_abs,fig3_macaca_cor,fig3_macaca_cor_abs,fig3_goldenSM_cor,fig3_goldenSM_cor_abs,ncol=2,align="vh")
ggsave("fig4.experience_data.related.svg",fig3,width = 6, height = 18)

